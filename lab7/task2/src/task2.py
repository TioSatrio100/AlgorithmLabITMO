import sys
import os

base_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '../../'))
sys.path.append(base_dir)

from utils import read_integers_from_file, write_array_to_file, measure_performance

def optimal_sequence(n):
    operations = []
    while n > 1:
        operations.append(n)
        if n % 3 == 0:
            n = n // 3
        elif n % 2 == 0:
            n = n // 2
        else:
            n = n - 1
    operations.append(1)
    return list(reversed(operations))

def process_file(input_file_path, output_file_path):
    n = read_integers_from_file(input_file_path)[0]
    
    sequence = optimal_sequence(n)
    write_array_to_file(output_file_path, [len(sequence) - 1] + sequence)

def main():
    script_dir = os.path.dirname(__file__)
    base_dir = os.path.abspath(os.path.join(script_dir, '..', '..', 'task2'))
    input_file_path = os.path.join(base_dir, 'txtf', 'input.txt')
    output_file_path = os.path.join(base_dir, 'txtf', 'output.txt')
    measure_performance(process_file, input_file_path, output_file_path)

if __name__ == "__main__":
    main()

